/*!
 * Tarmac Festival - Festival Allstedt v1.1.0 (https://tarmac-festival.de/)
 * Copyright 2019-2020 Martin Suckau
 */

$(function(){var s=$("#contactForm button#send"),i=$("#contactForm #sendSpinner"),l=$("#contactForm .form-help-section"),e=$("#contactForm input#subjectRadio1"),t=$("#contactForm input#subjectRadio2"),d=$("#contactForm input#arrival"),u=$("#contactForm input#departure"),f=$("#contactForm input#purposeCheck1"),m=$("#contactForm input#purposeCheck2"),h=$("#contactForm input#ageCheck"),p=$("#alertSuccess"),b=$("#alertFail");e.change(function(){"on"===this.value&&$("#contactForm .form-help-section").fadeOut("fast",function(){l.addClass("d-none"),d.removeAttr("required"),u.removeAttr("required"),h.removeAttr("required")})}),t.change(function(){"on"===this.value&&$("#contactForm .form-help-section").fadeIn("fast",function(){l.removeClass("d-none"),d.attr("required",!0),u.attr("required",!0),h.attr("required",!0)})}),$("#contactForm").on("submit",function(e){var a,n,t;e.preventDefault(),i.removeClass("d-none"),s.attr("disabled",!0),p.first().slideUp("fast"),b.first().slideUp("fast"),l.hasClass("d-none")?(a="contact@tarmac-festival.de",n="Allgemeine Anfrage",t=""):(a="helpinghands@tarmac-festival.de",n="Ich möchte helfen",t="<br>Anreisedatum: "+d.val()+"<br>Abreisedatum: "+u.val()+"<br>Helfen beim Aufbau: "+f.is(":checked")+"<br>Helfen beim Abbau: "+m.is(":checked")+"<br>Ich bin über 18: "+h.is(":checked"));var r=$("#contactForm input#name").val(),c=$("#contactForm input#email").val(),o="Nachricht von: "+r+" ["+c+"]<br>Betreff: "+n+t+"<br><br>"+$("textarea#message").val();grecaptcha.execute("6LcuY9QUAAAAACswQfBwCN5I8Q0x6fmFXEKGhV5d",{action:"validate_captcha"}).then(function(e){console.log("recaptcha token: "+e);var t=$.ajax({type:"POST",url:"/checkRecaptcha",data:{token:e,subject:n,name:r,email:a,message:o}});t.done(function(e,t){console.log("response: "+e,t),i.addClass("d-none"),s.attr("disabled",!1),"success"===e.result?(p.first().slideDown("fast").delay(5e3).slideUp("fast"),$("#contactForm").get(0).reset()):b.first().slideDown("fast")}),t.fail(function(e,t,a){console.error("Error while sending mail: "+t,a),b.first().slideDown("fast"),i.addClass("d-none"),s.attr("disabled",!1)})});return!1}),$('a[data-toggle="tab"]').click(function(e){e.preventDefault(),$(this).tab("show")})});