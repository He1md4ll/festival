/*!
 * Tarmac Festival - Festival Allstedt v1.1.0 (https://tarmac-festival.de/)
 * Copyright 2019-2020 Martin Suckau
 */

$(function(){var i=$("#contactForm button#send"),d=$("#contactForm #sendSpinner"),l=$("#contactForm .form-help-section"),e=$("#contactForm input#subjectRadio1"),t=$("#contactForm input#subjectRadio2"),u=$("#contactForm input#arrival"),m=$("#contactForm input#departure"),h=$("#contactForm input#purposeCheck1"),f=$("#contactForm input#purposeCheck2"),p=$("#contactForm input#ageCheck"),v=$("#alertSuccess"),b=$("#alertFail");e.change(function(){"on"===this.value&&$("#contactForm .form-help-section").fadeOut("fast",function(){l.addClass("d-none"),u.removeAttr("required"),m.removeAttr("required"),p.removeAttr("required")})}),t.change(function(){"on"===this.value&&$("#contactForm .form-help-section").fadeIn("fast",function(){l.removeClass("d-none"),u.attr("required",!0),m.attr("required",!0),p.attr("required",!0)})}),$("#contactForm").on("submit",function(e){e.preventDefault(),d.removeClass("d-none"),i.attr("disabled",!0),v.removeClass("show").addClass("d-none"),b.removeClass("show").addClass("d-none");var t=$("input#g-recaptcha-response").val();if(null!=t&&""!==t){var a,n,r;l.hasClass("d-none")?(a="contact@tarmac-festival.de",n="Allgemeine Anfrage",r=""):(a="helpinghands@tarmac-festival.de",n="Ich möchte helfen",r="<br>Anreisedatum: "+u.val()+"<br>Abreisedatum: "+m.val()+"<br>Helfen beim Aufbau: "+h.is(":checked")+"<br>Helfen beim Abbau: "+f.is(":checked")+"<br>Ich bin über 18: "+p.is(":checked"));var o=$("#contactForm input#name").val(),c="Nachricht von: "+o+" ["+$("#contactForm input#email").val()+"]<br>Betreff: "+n+r+"<br><br>"+$("textarea#message").val(),s=$.ajax({type:"POST",url:"/checkRecaptcha",data:{token:t,subject:n,name:o,email:a,message:c}});return s.done(function(e,t){console.log("response: "+e,t),d.addClass("d-none"),i.attr("disabled",!1),"success"===e.result?(v.addClass("show").removeClass("d-none"),v.delay(4e3).slideUp(200,function(){$(this).alert("close").addClass("d-none")}),$("#contactForm").get(0).reset()):b.addClass("show").removeClass("d-none")}),s.fail(function(e,t,a){console.error("Error while sending mail: "+t,a),b.addClass("show").removeClass("d-none"),d.addClass("d-none"),i.attr("disabled",!1)}),s.done(function(){grecaptcha.execute("6LcuY9QUAAAAACswQfBwCN5I8Q0x6fmFXEKGhV5d",{action:"re_validate_captcha"}).then(function(e){document.getElementById("g-recaptcha-response").value=e})}),!1}alert("Unerwarteter Fehler beim Senden deiner Nachricht")}),$('a[data-toggle="tab"]').click(function(e){e.preventDefault(),$(this).tab("show")})});