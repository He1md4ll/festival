/*!
 * Tarmac Festival - Festival Allstedt v1.1.0 (https://tarmac-festival.de/)
 * Copyright 2019-2020 Martin Suckau
 */

$(function(){var s=$("#contactForm button#send"),d=$("#contactForm #sendSpinner"),i=$("#contactForm .form-help-section"),e=$("#contactForm input#subjectRadio1"),t=$("#contactForm input#subjectRadio2"),l=$("#contactForm input#arrival"),u=$("#contactForm input#departure"),m=$("#contactForm input#purposeCheck1"),h=$("#contactForm input#purposeCheck2"),f=$("#contactForm input#ageCheck"),p=$("#alertSuccess"),v=$("#alertFail");e.change(function(){"on"===this.value&&$("#contactForm .form-help-section").fadeOut("fast",function(){i.addClass("d-none"),l.removeAttr("required"),u.removeAttr("required"),f.removeAttr("required")})}),t.change(function(){"on"===this.value&&$("#contactForm .form-help-section").fadeIn("fast",function(){i.removeClass("d-none"),l.attr("required",!0),u.attr("required",!0),f.attr("required",!0)})}),$("#contactForm").on("submit",function(e){var a,n,t;e.preventDefault(),d.removeClass("d-none"),s.attr("disabled",!0),p.removeClass("show").addClass("d-none"),v.removeClass("show").addClass("d-none"),i.hasClass("d-none")?(a="contact@tarmac-festival.de",n="Allgemeine Anfrage",t=""):(a="helpinghands@tarmac-festival.de",n="Ich möchte helfen",t="<br>Anreisedatum: "+l.val()+"<br>Abreisedatum: "+u.val()+"<br>Helfen beim Aufbau: "+m.is(":checked")+"<br>Helfen beim Abbau: "+h.is(":checked")+"<br>Ich bin über 18: "+f.is(":checked"));var o=$("#contactForm input#name").val(),r=$("#contactForm input#email").val(),c="Nachricht von: "+o+" ["+r+"]<br>Betreff: "+n+t+"<br><br>"+$("textarea#message").val();grecaptcha.execute("6LcuY9QUAAAAACswQfBwCN5I8Q0x6fmFXEKGhV5d",{action:"validate_captcha"}).then(function(e){console.log("recaptcha token: "+e);var t=$.ajax({type:"POST",url:"/checkRecaptcha",data:{token:e,subject:n,name:o,email:a,message:c}});t.done(function(e,t){console.log("response: "+e,t),d.addClass("d-none"),s.attr("disabled",!1),"success"===e.result?(p.addClass("show").removeClass("d-none"),p.delay(4e3).slideUp(200,function(){$(this).alert("close").addClass("d-none")}),$("#contactForm").get(0).reset()):v.addClass("show").removeClass("d-none")}),t.fail(function(e,t,a){console.error("Error while sending mail: "+t,a),v.addClass("show").removeClass("d-none"),d.addClass("d-none"),s.attr("disabled",!1)})});return!1}),$('a[data-toggle="tab"]').click(function(e){e.preventDefault(),$(this).tab("show")})});