/*!
 * Tarmac Festival - Festival Allstedt v1.1.0 (https://tarmac-festival.de/)
 * Copyright 2019-2020 Martin Suckau
 */

$(function(){var o=$("#contactForm button#send"),s=$("#contactForm #sendSpinner"),u=$("#contactForm .form-help-section"),e=$("#contactForm input#subjectRadio1"),t=$("#contactForm input#subjectRadio2"),l=$("#contactForm input#arrival"),d=$("#contactForm input#departure"),f=$("#contactForm input#purposeCheck1"),m=$("#contactForm input#purposeCheck2"),h=$("#contactForm input#ageCheck"),p=$("#alertSuccess"),b=$("#alertFail");e.change(function(){"on"===this.value&&u.each(function(){$(this).slideUp("fast",function(){l.removeAttr("required"),d.removeAttr("required"),h.removeAttr("required")})})}),t.change(function(){"on"===this.value&&u.each(function(){$(this).slideDown("fast",function(){l.attr("required",!0),d.attr("required",!0),h.attr("required",!0)})})}),$("#contactForm").on("submit",function(e){var a,r,t;e.preventDefault(),s.removeClass("d-none"),o.attr("disabled",!0),p.first().slideUp("fast"),b.first().slideUp("fast"),u.is(":visible")?(a="helpinghands@tarmac-festival.de",r="Ich möchte helfen",t="<br>Anreisedatum: "+l.val()+"<br>Abreisedatum: "+d.val()+"<br>Helfen beim Aufbau: "+f.is(":checked")+"<br>Helfen beim Abbau: "+m.is(":checked")+"<br>Ich bin über 18: "+h.is(":checked")):(a="contact@tarmac-festival.de",r="Allgemeine Anfrage",t="");var n=$("#contactForm input#name").val(),c=$("#contactForm input#email").val(),i="Nachricht von: "+n+" ["+c+"]<br>Betreff: "+r+t+"<br><br>"+$("textarea#message").val();grecaptcha.execute("6LcuY9QUAAAAACswQfBwCN5I8Q0x6fmFXEKGhV5d",{action:"validate_captcha"}).then(function(e){console.log("recaptcha token: "+e);var t=$.ajax({type:"POST",url:"/checkRecaptcha",data:{token:e,subject:r,name:n,userMail:c,userName:n,email:a,message:i}});t.done(function(e,t){console.log("response: "+e,t),s.addClass("d-none"),o.attr("disabled",!1),"success"===e.result?(p.first().slideDown("fast").delay(5e3).slideUp("fast"),$("#contactForm").get(0).reset(),u.each(function(){$(this).slideUp("fast",function(){l.removeAttr("required"),d.removeAttr("required"),h.removeAttr("required")})})):b.first().slideDown("fast")}),t.fail(function(e,t,a){console.error("Error while sending mail: "+t,a),b.first().slideDown("fast"),s.addClass("d-none"),o.attr("disabled",!1)})});return!1}),$('a[data-toggle="tab"]').click(function(e){e.preventDefault(),$(this).tab("show")})});